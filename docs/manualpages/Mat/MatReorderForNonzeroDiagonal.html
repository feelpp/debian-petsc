<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML3.2 EN">
<HTML>
<HEAD> <link rel="canonical" href="http://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/Mat/MatReorderForNonzeroDiagonal.html" />
<META NAME="GENERATOR" CONTENT="DOCTEXT">
<TITLE>MatReorderForNonzeroDiagonal</TITLE>
</HEAD>
<BODY BGCOLOR="FFFFFF">
   <div id="version" align=right><b>petsc-3.4.2 2013-07-02</b></div>
<A NAME="MatReorderForNonzeroDiagonal"><H1>MatReorderForNonzeroDiagonal</H1></A>
Changes matrix ordering to remove zeros from diagonal. This may help in the LU factorization to prevent a zero pivot. 
<H3><FONT COLOR="#CC3333">Synopsis</FONT></H3>
<PRE>
#include "petscmat.h"  
PetscErrorCode  MatReorderForNonzeroDiagonal(Mat mat,PetscReal abstol,IS ris,IS cis)
</PRE>
Collective on <A HREF="../Mat/Mat.html#Mat">Mat</A>
<P>
<H3><FONT COLOR="#CC3333">Input Parameters</FONT></H3>
<TABLE border="0" cellpadding="0" cellspacing="0">
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>mat  </B></TD><TD>- matrix to reorder
</TD></TR>
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>rmap,cmap </B></TD><TD>- row and column permutations.  Usually obtained from
<A HREF="../MatOrderings/MatGetOrdering.html#MatGetOrdering">MatGetOrdering</A>().
</TD></TR></TABLE>
<P>

<P>
<H3><FONT COLOR="#CC3333">Notes</FONT></H3>
This is not intended as a replacement for pivoting for matrices that
have ``bad'' structure. It is only a stop-gap measure. Should be called
after a call to <A HREF="../MatOrderings/MatGetOrdering.html#MatGetOrdering">MatGetOrdering</A>(), this routine changes the column
ordering defined in cis.
<P>
Only works for SeqAIJ matrices
<P>
<H3><FONT COLOR="#CC3333">Options Database Keys (When using KSP)</FONT></H3>
<DT><B>-pc_factor_nonzeros_along_diagonal</B> -
Algorithm Notes:
Column pivoting is used.
<br>
<P>
1) Choice of column is made by looking at the
non-zero elements in the troublesome row for columns that are not yet
included (moving from left to right).
<P>
2) If (1) fails we check all the columns to the left of the current row
and see if one of them has could be swapped. It can be swapped if
its corresponding row has a non-zero in the column it is being
swapped with; to make sure the previous nonzero diagonal remains
nonzero
<P>
<P>
<P><B><P><B><FONT COLOR="#CC3333">Level:</FONT></B>intermediate
<BR><FONT COLOR="#CC3333">Location:</FONT></B><A HREF="../../../src/mat/utils/zerodiag.c.html#MatReorderForNonzeroDiagonal">src/mat/utils/zerodiag.c</A>
<BR><A HREF="./index.html">Index of all Mat routines</A>
<BR><A HREF="../../index.html">Table of Contents for all manual pages</A>
<BR><A HREF="../singleindex.html">Index of all manual pages</A>
</BODY></HTML>
